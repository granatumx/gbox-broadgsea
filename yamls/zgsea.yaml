id: BroadGSEA-{VER}

meta:
  title: Broad GSEA {VER}
  subtitle: The canonical Gene Set Enrichment Analysis
  description: |
    Gene Set Enrichment Analysis (GSEA) helps identify the biological
    functions related to a list of genes. You must register your email address
    to use the data provided. You also agree to all terms and conditions
    provided by the Broad Institute in using the GSEA data. You should
    cite the relevant work if using the material for publication.

    [http://software.broadinstitute.org/gsea/index.jsp](http://software.broadinstitute.org/gsea/index.jsp)

endpoints:
  backend:
    cmd: python ./run_zgsea.py
    type: docker
    image: {GBOX}

frontend:
  args:
    - type: select
      label: The species
      choices:
        - label: Human
          value: human
        - label: Mouse
          description: genes are going to be mapped to their human homologs
          value: mouse
      default: human
      injectInto: species
    - type: select
      label: The database for the enrichement analysis
      choices:
        - label: Gene Ontology (GO)
          value: go
          description: >
            Gene Ontology (GO) term enrichment is a technique for interpreting
            sets of genes making use of the Gene Ontology system of
            classification, in which genes are assigned to a set of predefined
            bins depending on their functional characteristics. (From wikipedia)
        - label: Kyoto Encyclopedia of Genes and Genomes (KEGG)
          value: kegg
          description: >
            Kyoto Encyclopedia of Genes and Genomes (KEGG) is a collection of
            databases dealing with genomes, biological pathways, diseases,
            drugs, and chemical substances. (From wikipedia)
        - label: GSEA Hallmark Database
          value: hallmark
          description: >
            Hallmark gene sets summarize and represent specific well-defined biological 
            states or processes and display coherent expression. These gene sets were 
            generated by a computational methodology based on identifying overlaps between 
            gene sets in other MSigDB collections and retaining genes that display 
            coordinate expression. (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Positional Gene Sets
          value: C1
          description: >
            Gene sets corresponding to human chromosome cytogenetic bands.
            (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Curated Gene Sets
          value: C2
          description: >
            Gene sets in this collection are curated from various sources, including 
            online pathway databases and the biomedical literature. Many sets are also 
            contributed by individual domain experts. The gene set page for each gene set 
            lists its source. The C2 collection is divided into the following two 
            sub-collections -- Chemical and genetic perturbations (CGP) and Canonical pathways (CP).
            (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Regulatory Target Gene Sets
          value: C3
          description: >
            Gene sets representing potential targets of regulation by transcription factors 
            or microRNAs. The sets consist of genes grouped by elements they share in their 
            non-protein coding regions. The elements represent known or likely cis-regulatory 
            elements in promoters and 3'-UTRs. The C3 collection is divided into two sub-collections -- 
            microRNA targets (MIR) and transcription factor targets (TFT).
            (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Computational Gene Sets
          value: C4
          description: >
            Computational gene sets defined by mining large collections of cancer-oriented 
            microarray data. The C4 collection is divided into two sub-collections -- CGN and CM.
            (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Ontology Gene Sets
          value: C5
          description: >
            Gene sets that contain genes annotated by the same ontology term. The C5 
            collection is divided into two sub-collections, the first derived from the 
            Gene Ontology resource (GO) which contains BP, CC, and MF components and a 
            second derived from the Human Phenotype Ontology (HPO). (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Oncogenic Signature Gene Sets
          value: C6
          description: >
            Gene sets that represent signatures of cellular pathways which are often 
            dis-regulated in cancer. The majority of signatures were generated directly 
            from microarray data from NCBI GEO or from internal unpublished profiling 
            experiments involving perturbation of known cancer genes. (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Immunologic Signature Gene Sets
          value: C7
          description: >
            Gene sets that represent cell states and perturbations within the immune system. (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Cell Type Database
          value: C8
          description: >
            Gene sets that contain curated cluster markers for cell types identified 
            in single-cell sequencing studies of human tissue. (From gsea-msigdb.org, accessed 12/10/2022)
        - label: GSEA Wikipathways
          value: WP
          description: >
            Gene sets from wikipathways (From gsea-msigdb.org, accessed 12/10/2022)
      default: go
      injectInto: gset_group_id
    - type: number
      label: Number of repeats for calculating p-values
      min: 0
      max: 1000000
      default: 1000
      injectInto: n_repeats
    - type: select
      label: Filter data
      choices:
        - label: Do not filter or alter scoring
          value: unaltered
          description: >
            Do not alter the scoring
        - label: Only take positively scored genes
          value: pos
          description: >
            If genes have a positive score (for example log FC or Z score), they are expressed more in the cluster.
        - label: Only take negatively scored genes, and rank lower scores higher
          value: neg
          description: >
            If genes have a negative score, they are expressed less in the cluster.
      default: unaltered
      injectInto: alterChoice
  imports:
    - kind: geneMeta
      label: A list of genes with their scores (usually output from scanpy scoring for example)
      injectInto: gene_scores
